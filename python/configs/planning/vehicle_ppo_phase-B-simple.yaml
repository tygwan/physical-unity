# Phase B: Decision Learning - PPO Configuration (Simplified)
# Focuses on validating and enhancing overtaking decision-making
# Created: 2026-01-28
# Note: Curriculum managed in Unity, not ML-Agents config

behaviors:
  E2EDrivingAgent:
    trainer_type: ppo

    hyperparameters:
      batch_size: 4096
      buffer_size: 40960
      learning_rate: 3e-4
      learning_rate_schedule: constant
      beta: 5e-3
      epsilon: 0.2
      lambd: 0.99
      num_epoch: 10
      shared_critic: false
      tau: 0.005
      time_horizon: 2048
      max_steps: 3000000
      summary_freq: 50000
      checkpoint_interval: 500000
      normalize: true
      use_recurrent: false
      memory_size: 256
      sequence_length: 64

    network_settings:
      normalize: true
      hidden_units: 512
      num_layers: 3

    reward_signals:
      extrinsic:
        gamma: 0.995
        strength: 1.0
        network_settings:
          normalize: false
          hidden_units: 128
          num_layers: 2

    # INITIALIZATION: Phase 0 checkpoint (conservative approach)
    init_path: results/phase-0-foundation/E2EDrivingAgent/E2EDrivingAgent-8000047.pt

    keep_checkpoints: 5
    max_steps: 3000000

environment_parameters:
  num_active_npcs: 2
  npc_speed_range_min: 8.0
  npc_speed_range_max: 15.0
  min_required_overtakes: 1
  overtaking_bonus_multiplier: 2.0
  speed_reward_weight: 0.3
  lane_center_weight: 0.2
  following_penalty_enabled: true
