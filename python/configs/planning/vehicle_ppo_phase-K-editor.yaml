behaviors:
  E2EDrivingAgent:
    trainer_type: ppo
    hyperparameters:
      batch_size: 4096
      buffer_size: 40960
      learning_rate: 0.00015
      beta: 0.005
      epsilon: 0.2
      lambd: 0.95
      num_epoch: 5
      learning_rate_schedule: constant
      beta_schedule: constant
      epsilon_schedule: constant
    network_settings:
      normalize: false
      hidden_units: 512
      num_layers: 3
    reward_signals:
      extrinsic:
        gamma: 0.99
        strength: 1.0
    init_path: results/phase-J-v5/E2EDrivingAgent/E2EDrivingAgent-5000148.pt
    max_steps: 5000000
    time_horizon: 256
    summary_freq: 10000
    keep_checkpoints: 10
    checkpoint_interval: 500000
    threaded: false
environment_parameters:
  goal_distance:
    curriculum:
    - name: FullGoal
      value: 230.0
  num_lanes:
    curriculum:
    - name: TwoLanes
      value: 2.0
  center_line_enabled:
    curriculum:
    - name: CenterLineEnforced
      value: 1.0
  num_active_npcs:
    curriculum:
    - name: ThreeNPCs
      value: 3.0
  npc_speed_ratio:
    curriculum:
    - name: NormalNPCs
      value: 0.85
  npc_speed_variation:
    curriculum:
    - name: FullVariation
      value: 0.15
  turn_direction:
    curriculum:
    - name: RightTurn
      value: 2.0
  intersection_type:
    curriculum:
    - name: YJunction
      value: 3.0
  traffic_signal_enabled:
    curriculum:
    - name: SignalActive
      value: 1.0
  signal_green_ratio:
    curriculum:
    - name: HardGreen
      value: 0.4
  speed_zone_count:
    curriculum:
    - name: OneZone
      value: 1.0
  curve_direction_variation:
    curriculum:
    - name: RandomCurves
      value: 0.5
  road_curvature:
    curriculum:
    - name: NoCurve
      completion_criteria:
        measure: reward
        behavior: E2EDrivingAgent
        signal_smoothing: true
        min_lesson_length: 3000
        threshold: 490.0
      value: 0.0
    - name: LightCurve
      completion_criteria:
        measure: reward
        behavior: E2EDrivingAgent
        signal_smoothing: true
        min_lesson_length: 3000
        threshold: 430.0
      value: 0.3
    - name: MediumCurve
      value: 0.5
torch_settings:
  device: cuda
